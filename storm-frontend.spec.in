%define name         storm-frontend-server
%define version      @VERSION@
%define release      @STORM_FRONTEND_RELEASE_NUMBER@
%define flavor       @GLOBUS_FLAVOR@
%define builddir     $RPM_BUILD_DIR/%{name}-%{flavor}-%{version}
#%define globusdir    @GLOBUS_LOCATION@
#%define stormdir     @STORM_DIR@
#%define glitedir     @GLITE_LOCATION@
#%define gsoapdir     @GSOAP_DIR@
#%define gsoapgsidir  @GSOAPGSI_DIR@
#%define mysqldir     @MYSQL_DIR@
#%define xmlrpccdir   @XMLRPC_C_DIR@
%define prefix       @PREFIX@

Name:           %{name}-%{flavor}
Version:        %{version}
Release:        %{release}
Vendor:         INFN - CNAF (2009)
Packager:       Alberto Forti <alberto.forti@cnaf.infn.it> 
Copyright:      Apache License, Version 2.0.
URL:            http://storm.forge.cnaf.infn.it
Source:         @PACKAGE@-%{version}.tar.gz
Group:          Application/Generic
AutoReqProv:    no
Requires:       curl >= 7.15.3
Requires:       xmlrpc-c >= 1.04
Requires:       CGSI_gSOAP_2.7-voms >= 1.2.1-2
Obsoletes:      srmv2-storm-server
BuildRoot:      /var/tmp/%{name}-%{version}
Prefix:         %{prefix}
Summary:        The StoRM FrontEnd component. 

%description
This is the installation bundle for the StoRM FrontEnd server.

StoRM provides an SRM interface to any POSIX
filesystem with direct file access ("file:" transport protocol), but
can take advantage of special features of high performance parallel and cluster file systems, as 
GPFS from IBM and Lustre from SUN.


%prep
%setup -n @PACKAGE@-%{version}

%build
#./configure --prefix=%{prefix} --with-globus-location=%{globusdir} --with-globus-flavor=%{flavor} --with-glite-location=%{glitedir} --with-gsoap-dir=%{gsoapdir} --with-storm-dir=%{stormdir} --with-mysql-dir=%{mysqldir} --with-xmlrpc-c-dir=%{xmlrpccdir}
./configure --prefix=%{prefix} 
make

%install
if [ -d $RPM_BUILD_ROOT ]; then rm -rf $RPM_BUILD_ROOT; fi
mkdir -p $RPM_BUILD_ROOT
make install DESTDIR=$RPM_BUILD_ROOT

%clean
rm -rf $RPM_BUILD_ROOT

%files
%defattr(-,root,root)
/etc/cron.d/storm-frontend.cron
%{prefix}/etc/logrotate/storm-frontend.logrotate
%{prefix}/sbin/storm-frontend
%{prefix}/wsdl/srm.v2.2.wsdl
%{prefix}/etc/storm-frontend.conf.template
%defattr(755,root,root)
%config(noreplace) /etc/init.d/storm-frontend

